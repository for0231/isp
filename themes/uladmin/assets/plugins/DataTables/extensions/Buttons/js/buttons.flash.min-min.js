!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,i){return e||(e=window),i&&i.fn.dataTable||(i=require("datatables.net")(e,i).$),i.fn.dataTable.Buttons||require("datatables.net-buttons")(e,i),t(i,e,e.document)}:t(jQuery,window,document)}(function(t,e,i,s){var n=t.fn.dataTable,o={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(t){return"string"==typeof t&&(t=i.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(t){this.removeClass(t),this.className+=" "+t},t.removeClass=function(t){this.className=this.className.replace(RegExp("\\s*"+t+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},t.hasClass=function(t){return!!this.className.match(RegExp("\\s*"+t+"\\s*"))}),t},setMoviePath:function(t){this.moviePath=t},dispatch:function(t,e,i){(t=this.clients[t])&&t.receiveEvent(e,i)},register:function(t,e){this.clients[t]=e},getDOMObjectPosition:function(t){var e={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};for(""!==t.style.width&&(e.width=t.style.width.replace("px","")),""!==t.style.height&&(e.height=t.style.height.replace("px",""));t;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e},Client:function(t){this.handlers={},this.id=o.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,o.register(this.id,this),t&&this.glue(t)}};o.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(t,e){this.domElement=o.$(t);var s=99;this.domElement.style.zIndex&&(s=parseInt(this.domElement.style.zIndex,10)+1);var n=o.getDOMObjectPosition(this.domElement);this.div=i.createElement("div");var a=this.div.style;a.position="absolute",a.left="0px",a.top="0px",a.width=n.width+"px",a.height=n.height+"px",a.zIndex=s,void 0!==e&&""!==e&&(this.div.title=e),0!==n.width&&0!==n.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(n.width,n.height).replace(/&/g,"&amp;"))},positionElement:function(){var t=o.getDOMObjectPosition(this.domElement),e=this.div.style;e.position="absolute",e.width=t.width+"px",e.height=t.height+"px",0!==t.width&&0!==t.height&&(this.sized=!0,e=this.div.childNodes[0],e.width=t.width,e.height=t.height)},getHTML:function(t,e){var i="",s="id="+this.id+"&width="+t+"&height="+e;if(navigator.userAgent.match(/MSIE/))var n=location.href.match(/^https/i)?"https://":"http://",i=i+'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+n+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+t+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+o.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>';else i+='<embed id="'+this.movieId+'" src="'+o.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var e=this;this.domElement&&this.div&&(t(this.div).remove(),this.div=this.domElement=null,t.each(o.clients,function(t,i){i===e&&delete o.clients[t]}))},reposition:function(t){if(t&&((this.domElement=o.$(t))||this.hide()),this.domElement&&this.div){var t=o.getDOMObjectPosition(this.domElement),e=this.div.style;e.left=t.left+"px",e.top=t.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(t){this.clipText+=t,this.ready&&this.movie.appendText(t)},setText:function(t){this.clipText=t,this.ready&&this.movie.setText(t)},setFileName:function(t){this.fileName=t,this.ready&&this.movie.setFileName(t)},setAction:function(t){this.action=t,this.ready&&this.movie.setAction(t)},addEventListener:function(t,e){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},setHandCursor:function(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(t,s){var n,t=t.toString().toLowerCase().replace(/^on/,"");switch(t){case"load":if(this.movie=i.getElementById(this.movieId),!this.movie)return n=this,void setTimeout(function(){n.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return n=this,setTimeout(function(){n.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[t])for(var o=0,a=this.handlers[t].length;o<a;o++){var r=this.handlers[t][o];"function"==typeof r?r(this,s):"object"==typeof r&&2==r.length?r[0][r[1]](this,s):"string"==typeof r&&e[r](this,s)}}},o.hasFlash=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==s&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},e.ZeroClipboard_TableTools=o;var a=function(t,e){e.attr("id"),e.parents("html").length?t.glue(e[0],""):setTimeout(function(){a(t,e)},500)},r=function(e,i){var n="*"===e.filename&&"*"!==e.title&&e.title!==s?e.title:e.filename;return-1!==n.indexOf("*")&&(n=n.replace("*",t("title").text())),n=n.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),i===s||!0===i?n+e.extension:n},l=function(e){return e=e.title,-1!==e.indexOf("*")?e.replace("*",t("title").text()):e},h=function(t,e){var i=e.match(/[\s\S]{1,8192}/g)||[];t.clearText();for(var s=0,n=i.length;s<n;s++)t.appendText(i[s])},c=function(t,e){for(var i=e.newline?e.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n",n=t.buttons.exportData(e.exportOptions),o=e.fieldBoundary,a=e.fieldSeparator,r=RegExp(o,"g"),l=e.escapeChar!==s?e.escapeChar:"\\",h=function(t){for(var e="",i=0,s=t.length;i<s;i++)0<i&&(e+=a),e+=o?o+(""+t[i]).replace(r,l+o)+o:t[i];return e},c=e.header?h(n.header)+i:"",d=e.footer?i+h(n.footer):"",f=[],u=0,m=n.body.length;u<m;u++)f.push(h(n.body[u]));return{str:c+f.join(i)+d,rows:f.length}},d={available:function(){return o.hasFlash()},init:function(t,e,i){o.moviePath=n.Buttons.swfPath;var s=new o.Client;s.setHandCursor(!0),s.addEventListener("mouseDown",function(){i._fromFlash=!0,t.button(e[0]).trigger(),i._fromFlash=!1}),a(s,e),i._flash=s},destroy:function(t,e,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",filename:"*",extension:".csv",header:!0,footer:!1};return n.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",n.Api.register("buttons.resize()",function(){t.each(o.clients,function(t,e){e.domElement!==s&&e.domElement.parentNode&&e.positionElement()})}),n.ext.buttons.copyFlash=t.extend({},d,{className:"buttons-copy buttons-flash",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(t,e,i,s){s._fromFlash&&(t=s._flash,s=c(e,s),t.setAction("copy"),h(t,s.str),e.buttons.info(e.i18n("buttons.copyTitle","Copy to clipboard"),e.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},s.rows),3e3))},fieldSeparator:"\t",fieldBoundary:""}),n.ext.buttons.csvFlash=t.extend({},d,{className:"buttons-csv buttons-flash",text:function(t){return t.i18n("buttons.csv","CSV")},action:function(t,e,i,s){t=s._flash,e=c(e,s),t.setAction("csv"),t.setFileName(r(s)),h(t,e.str)},escapeChar:'"'}),n.ext.buttons.excelFlash=t.extend({},d,{className:"buttons-excel buttons-flash",text:function(t){return t.i18n("buttons.excel","Excel")},action:function(t,e,i,n){var t="",i=n._flash,e=e.buttons.exportData(n.exportOptions),o=function(t){for(var e=[],i=0,n=t.length;i<n;i++)null!==t[i]&&t[i]!==s||(t[i]=""),e.push("number"==typeof t[i]||t[i].match&&t[i].match(/^-?[0-9\.]+$/)&&"0"!==t[i].charAt(0)?'<c t="n"><v>'+t[i]+"</v></c>":'<c t="inlineStr"><is><t>'+(t[i].replace?t[i].replace(/&(?!amp;)/g,"&amp;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):t[i])+"</t></is></c>");return"<row>"+e.join("")+"</row>"};n.header&&(t+=o(e.header));for(var a=0,l=e.body.length;a<l;a++)t+=o(e.body[a]);n.footer&&(t+=o(e.footer)),i.setAction("excel"),i.setFileName(r(n)),h(i,t)},extension:".xlsx"}),n.ext.buttons.pdfFlash=t.extend({},d,{className:"buttons-pdf buttons-flash",text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(t,e,i,s){var t=s._flash,i=e.buttons.exportData(s.exportOptions),n=e.table().node().offsetWidth,o=e.columns(s.columns).indexes().map(function(t){return e.column(t).header().offsetWidth/n});t.setAction("pdf"),t.setFileName(l(s)),h(t,JSON.stringify({title:r(s,!1),message:s.message,colWidth:o.toArray(),orientation:s.orientation,size:s.pageSize,header:s.header?i.header:null,footer:s.footer?i.footer:null,body:i.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"}),n.Buttons});