!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function($){return t($,window,document)}):"object"==typeof exports?module.exports=function(e,$){return e||(e=window),$&&$.fn.dataTable||($=require("datatables.net")(e,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(e,$),t($,e,e.document)}:t(jQuery,window,document)}(function($,t,e,i){"use strict";var s=$.fn.dataTable,n={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(t){return"string"==typeof t&&(t=e.getElementById(t)),t.addClass||(t.hide=function(){this.style.display="none"},t.show=function(){this.style.display=""},t.addClass=function(t){this.removeClass(t),this.className+=" "+t},t.removeClass=function(t){this.className=this.className.replace(new RegExp("\\s*"+t+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},t.hasClass=function(t){return!!this.className.match(new RegExp("\\s*"+t+"\\s*"))}),t},setMoviePath:function(t){this.moviePath=t},dispatch:function(t,e,i){var s=this.clients[t];s&&s.receiveEvent(e,i)},register:function(t,e){this.clients[t]=e},getDOMObjectPosition:function(t){var e={left:0,top:0,width:t.width?t.width:t.offsetWidth,height:t.height?t.height:t.offsetHeight};for(""!==t.style.width&&(e.width=t.style.width.replace("px","")),""!==t.style.height&&(e.height=t.style.height.replace("px",""));t;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e},Client:function(t){this.handlers={},this.id=n.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,n.register(this.id,this),t&&this.glue(t)}};n.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,glue:function(t,i){this.domElement=n.$(t);var s=99;this.domElement.style.zIndex&&(s=parseInt(this.domElement.style.zIndex,10)+1);var o=n.getDOMObjectPosition(this.domElement);this.div=e.createElement("div");var a=this.div.style;a.position="absolute",a.left="0px",a.top="0px",a.width=o.width+"px",a.height=o.height+"px",a.zIndex=s,void 0!==i&&""!==i&&(this.div.title=i),0!==o.width&&0!==o.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(o.width,o.height).replace(/&/g,"&amp;"))},positionElement:function(){var t=n.getDOMObjectPosition(this.domElement),e=this.div.style;if(e.position="absolute",e.width=t.width+"px",e.height=t.height+"px",0!==t.width&&0!==t.height){this.sized=!0;var i=this.div.childNodes[0];i.width=t.width,i.height=t.height}},getHTML:function(t,e){var i="",s="id="+this.id+"&width="+t+"&height="+e;if(navigator.userAgent.match(/MSIE/)){i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+(location.href.match(/^https/i)?"https://":"http://")+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+t+'" height="'+e+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+n.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>'}else i+='<embed id="'+this.movieId+'" src="'+n.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+t+'" height="'+e+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var t=this;this.domElement&&this.div&&($(this.div).remove(),this.domElement=null,this.div=null,$.each(n.clients,function(e,i){i===t&&delete n.clients[e]}))},reposition:function(t){if(t&&(this.domElement=n.$(t),this.domElement||this.hide()),this.domElement&&this.div){var e=n.getDOMObjectPosition(this.domElement),i=this.div.style;i.left=e.left+"px",i.top=e.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(t){this.clipText+=t,this.ready&&this.movie.appendText(t)},setText:function(t){this.clipText=t,this.ready&&this.movie.setText(t)},setFileName:function(t){this.fileName=t,this.ready&&this.movie.setFileName(t)},setAction:function(t){this.action=t,this.ready&&this.movie.setAction(t)},addEventListener:function(t,e){t=t.toString().toLowerCase().replace(/^on/,""),this.handlers[t]||(this.handlers[t]=[]),this.handlers[t].push(e)},setHandCursor:function(t){this.handCursorEnabled=t,this.ready&&this.movie.setHandCursor(t)},setCSSEffects:function(t){this.cssEffects=!!t},receiveEvent:function(i,s){var n;switch(i=i.toString().toLowerCase().replace(/^on/,"")){case"load":if(this.movie=e.getElementById(this.movieId),!this.movie)return n=this,void setTimeout(function(){n.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return n=this,setTimeout(function(){n.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1);break}if(this.handlers[i])for(var o=0,a=this.handlers[i].length;o<a;o++){var r=this.handlers[i][o];"function"==typeof r?r(this,s):"object"==typeof r&&2==r.length?r[0][r[1]](this,s):"string"==typeof r&&t[r](this,s)}}},n.hasFlash=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==i&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},t.ZeroClipboard_TableTools=n;var o=function(t,e){var i=e.attr("id");e.parents("html").length?t.glue(e[0],""):setTimeout(function(){o(t,e)},500)},a=function(t,e){var s="*"===t.filename&&"*"!==t.title&&t.title!==i?t.title:t.filename;return-1!==s.indexOf("*")&&(s=s.replace("*",$("title").text())),s=s.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),e===i||!0===e?s+t.extension:s},r=function(t){var e=t.title;return-1!==e.indexOf("*")?e.replace("*",$("title").text()):e},l=function(t,e){var i=e.match(/[\s\S]{1,8192}/g)||[];t.clearText();for(var s=0,n=i.length;s<n;s++)t.appendText(i[s])},h=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"},c=function(t,e){for(var s=h(e),n=t.buttons.exportData(e.exportOptions),o=e.fieldBoundary,a=e.fieldSeparator,r=new RegExp(o,"g"),l=e.escapeChar!==i?e.escapeChar:"\\",c=function(t){for(var e="",i=0,s=t.length;i<s;i++)i>0&&(e+=a),e+=o?o+(""+t[i]).replace(r,l+o)+o:t[i];return e},d=e.header?c(n.header)+s:"",f=e.footer?s+c(n.footer):"",u=[],m=0,p=n.body.length;m<p;m++)u.push(c(n.body[m]));return{str:d+u.join(s)+f,rows:u.length}},d={available:function(){return n.hasFlash()},init:function(t,e,i){n.moviePath=s.Buttons.swfPath;var a=new n.Client;a.setHandCursor(!0),a.addEventListener("mouseDown",function(s){i._fromFlash=!0,t.button(e[0]).trigger(),i._fromFlash=!1}),o(a,e),i._flash=a},destroy:function(t,e,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",filename:"*",extension:".csv",header:!0,footer:!1};return s.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",s.Api.register("buttons.resize()",function(){$.each(n.clients,function(t,e){e.domElement!==i&&e.domElement.parentNode&&e.positionElement()})}),s.ext.buttons.copyFlash=$.extend({},d,{className:"buttons-copy buttons-flash",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(t,e,i,s){if(s._fromFlash){var n=s._flash,o=c(e,s);n.setAction("copy"),l(n,o.str),e.buttons.info(e.i18n("buttons.copyTitle","Copy to clipboard"),e.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},o.rows),3e3)}},fieldSeparator:"\t",fieldBoundary:""}),s.ext.buttons.csvFlash=$.extend({},d,{className:"buttons-csv buttons-flash",text:function(t){return t.i18n("buttons.csv","CSV")},action:function(t,e,i,s){var n=s._flash,o=c(e,s);n.setAction("csv"),n.setFileName(a(s)),l(n,o.str)},escapeChar:'"'}),s.ext.buttons.excelFlash=$.extend({},d,{className:"buttons-excel buttons-flash",text:function(t){return t.i18n("buttons.excel","Excel")},action:function(t,e,s,n){var o="",r=n._flash,h=e.buttons.exportData(n.exportOptions),c=function(t){for(var e=[],s=0,n=t.length;s<n;s++)null!==t[s]&&t[s]!==i||(t[s]=""),e.push("number"==typeof t[s]||t[s].match&&t[s].match(/^-?[0-9\.]+$/)&&"0"!==t[s].charAt(0)?'<c t="n"><v>'+t[s]+"</v></c>":'<c t="inlineStr"><is><t>'+(t[s].replace?t[s].replace(/&(?!amp;)/g,"&amp;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):t[s])+"</t></is></c>");return"<row>"+e.join("")+"</row>"};n.header&&(o+=c(h.header));for(var d=0,f=h.body.length;d<f;d++)o+=c(h.body[d]);n.footer&&(o+=c(h.footer)),r.setAction("excel"),r.setFileName(a(n)),l(r,o)},extension:".xlsx"}),s.ext.buttons.pdfFlash=$.extend({},d,{className:"buttons-pdf buttons-flash",text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(t,e,i,s){var n=s._flash,o=e.buttons.exportData(s.exportOptions),h=e.table().node().offsetWidth,c=e.columns(s.columns).indexes().map(function(t){return e.column(t).header().offsetWidth/h});n.setAction("pdf"),n.setFileName(r(s)),l(n,JSON.stringify({title:a(s,!1),message:s.message,colWidth:c.toArray(),orientation:s.orientation,size:s.pageSize,header:s.header?o.header:null,footer:s.footer?o.footer:null,body:o.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"}),s.Buttons});